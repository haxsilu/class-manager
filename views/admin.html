<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Dashboard â€¢ Class Management System</title>
  <link rel="stylesheet" href="/css/app.css" />
  <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js" defer></script>
  <script src="/js/admin.js" defer></script>
</head>
<body class="bg-night text-slate">
  <header class="top-bar">
    <div>
      <p class="eyebrow">Administrator</p>
      <h1>Class Management System</h1>
    </div>
    <button id="logout-btn" class="btn-ghost">Logout</button>
  </header>

  <main class="page-shell">
    <div class="tab-buttons" id="admin-tabs" role="tablist">
      <button class="chip active" data-target="dashboard">Dashboard</button>
      <button class="chip" data-target="students">Students</button>
      <button class="chip" data-target="classes">Classes</button>
      <button class="chip" data-target="enrollments">Enrollments</button>
      <button class="chip" data-target="scanner">QR Scanner</button>
      <button class="chip" data-target="attendance">Attendance</button>
      <button class="chip" data-target="payments">Payments</button>
      <button class="chip" data-target="unpaid">Unpaid</button>
      <button class="chip" data-target="finance">Finance</button>
      <button class="chip" data-target="exam">Exam Admin</button>
      <button class="chip" data-target="settings">Settings</button>
    </div>

    <!-- Dashboard -->
    <section class="card show" data-section="dashboard">
      <header class="section-head">
        <div>
          <p class="eyebrow">Snapshot</p>
          <h2>Overview</h2>
        </div>
        <button class="btn-minor" id="refresh-dashboard">Refresh</button>
      </header>
      <div class="grid stats" id="dashboard-stats"></div>
    </section>

    <!-- Students -->
    <section class="card" data-section="students">
      <header class="section-head">
        <div>
          <p class="eyebrow">Manage roster</p>
          <h2>Students</h2>
        </div>
        <div class="actions">
          <button class="btn-minor" id="refresh-students">Reload</button>
        </div>
      </header>
      <form id="student-form" class="form-grid">
        <input type="hidden" id="student-id" />
        <label>
          <span>Name</span>
          <input type="text" id="student-name" required />
        </label>
        <label>
          <span>Phone (username)</span>
          <input type="tel" id="student-phone" required />
        </label>
        <label>
          <span>Grade</span>
          <select id="student-grade" required>
            <option value="">Select grade</option>
            <option>Grade 6</option>
            <option>Grade 7</option>
            <option>Grade 8</option>
            <option>O/L</option>
          </select>
        </label>
        <div class="form-actions">
          <button type="submit" class="btn-primary">Save Student</button>
          <button type="button" id="student-cancel" class="btn-ghost">Clear</button>
        </div>
      </form>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Phone</th>
              <th>Grade</th>
              <th>QR Token</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="students-table"></tbody>
        </table>
      </div>
    </section>

    <!-- Classes -->
    <section class="card" data-section="classes">
      <header class="section-head">
        <div>
          <p class="eyebrow">Tuition groups</p>
          <h2>Classes</h2>
        </div>
      </header>
      <form id="class-form" class="form-grid compact">
        <label>
          <span>Name</span>
          <input type="text" id="class-name" placeholder="Grade 9" required />
        </label>
        <label>
          <span>Monthly fee (Rs)</span>
          <input type="number" id="class-fee" min="0" value="2000" required />
        </label>
        <button type="submit" class="btn-primary">Add Class</button>
      </form>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Fee (Rs)</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="classes-table"></tbody>
        </table>
      </div>
    </section>

    <!-- Enrollments -->
    <section class="card" data-section="enrollments">
      <header class="section-head">
        <div>
          <p class="eyebrow">Class rosters</p>
          <h2>Enrollments</h2>
        </div>
      </header>
      <form id="enroll-form" class="form-grid compact">
        <label>
          <span>Student</span>
          <select id="enroll-student" required></select>
        </label>
        <label>
          <span>Class</span>
          <select id="enroll-class" required></select>
        </label>
        <button type="submit" class="btn-primary">Enroll</button>
      </form>
      <div class="table-wrap">
        <div class="inline-fields">
          <label>
            <span>View class</span>
            <select id="enroll-view-class"></select>
          </label>
        </div>
        <table>
          <thead>
            <tr>
              <th>Student</th>
              <th>Phone</th>
              <th>Grade</th>
            </tr>
          </thead>
          <tbody id="enrollments-table"></tbody>
        </table>
      </div>
    </section>

    <!-- QR Scanner -->
    <section class="card" data-section="scanner">
      <header class="section-head">
        <div>
          <p class="eyebrow">Touchless attendance</p>
          <h2>QR Scanner</h2>
        </div>
        <button class="btn-minor" id="restart-scanner">Restart camera</button>
      </header>
      <div id="qr-reader" class="qr-shell"></div>
      <div id="scan-result" class="scan-result"></div>
    </section>

    <!-- Attendance -->
    <section class="card" data-section="attendance">
      <header class="section-head">
        <div>
          <p class="eyebrow">Daily presence</p>
          <h2>Attendance</h2>
        </div>
      </header>
      <form id="attendance-filter" class="form-grid compact">
        <label>
          <span>Class</span>
          <select id="attendance-class" required></select>
        </label>
        <label>
          <span>Date</span>
          <input type="date" id="attendance-date" required />
        </label>
        <button type="submit" class="btn-primary">Load</button>
      </form>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Student</th>
              <th>Grade</th>
              <th>Present</th>
            </tr>
          </thead>
          <tbody id="attendance-table"></tbody>
        </table>
      </div>
    </section>

    <!-- Payments -->
    <section class="card" data-section="payments">
      <header class="section-head">
        <div>
          <p class="eyebrow">Monthly dues</p>
          <h2>Payments</h2>
        </div>
      </header>
      <form id="payment-form" class="form-grid">
        <label>
          <span>Student</span>
          <select id="payment-student" required></select>
        </label>
        <label>
          <span>Class</span>
          <select id="payment-class" required></select>
        </label>
        <label>
          <span>Month (YYYY-MM)</span>
          <input type="month" id="payment-month" required />
        </label>
        <label>
          <span>Amount (Rs)</span>
          <input type="number" id="payment-amount" min="0" required />
        </label>
        <label>
          <span>Method</span>
          <select id="payment-method">
            <option>cash</option>
            <option>bank</option>
            <option>online</option>
          </select>
        </label>
        <button type="submit" class="btn-primary">Record Payment</button>
      </form>
    </section>

    <!-- Unpaid -->
    <section class="card" data-section="unpaid">
      <header class="section-head">
        <div>
          <p class="eyebrow">Follow-up</p>
          <h2>Unpaid Students</h2>
        </div>
      </header>
      <form id="unpaid-form" class="form-grid compact">
        <label>
          <span>Month</span>
          <input type="month" id="unpaid-month" required />
        </label>
        <button type="submit" class="btn-primary">Load</button>
      </form>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Class</th>
              <th>Student</th>
              <th>Phone</th>
            </tr>
          </thead>
          <tbody id="unpaid-table"></tbody>
        </table>
      </div>
    </section>

    <!-- Finance -->
    <section class="card" data-section="finance">
      <header class="section-head">
        <div>
          <p class="eyebrow">Revenue</p>
          <h2>Finance Report</h2>
        </div>
      </header>
      <form id="finance-form" class="form-grid compact">
        <label>
          <span>Month</span>
          <input type="month" id="finance-month" required />
        </label>
        <button type="submit" class="btn-primary">Load</button>
      </form>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Class</th>
              <th>Payments</th>
              <th>Total (Rs)</th>
            </tr>
          </thead>
          <tbody id="finance-table"></tbody>
          <tfoot>
            <tr>
              <td colspan="2" class="text-right">Grand Total</td>
              <td id="finance-total">0</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </section>

    <!-- Exam Admin -->
    <section class="card" data-section="exam">
      <header class="section-head">
        <div>
          <p class="eyebrow">December 5th</p>
          <h2>Exam Seat Monitor</h2>
        </div>
      </header>
      <div class="inline-fields">
        <label>
          <span>Session</span>
          <select id="exam-slot-admin"></select>
        </label>
      </div>
      <div id="exam-layout-admin" class="seat-layout read-only"></div>
      <p class="legend">Blue = Grade 7, Green = Grade 8</p>
    </section>

    <!-- Settings -->
    <section class="card" data-section="settings">
      <header class="section-head">
        <div>
          <p class="eyebrow">Maintenance</p>
          <h2>Settings</h2>
        </div>
      </header>
      <div class="settings-grid">
        <div>
          <h3>Database</h3>
          <p>Download a snapshot of <code>class_manager.db</code> for backups.</p>
          <a class="btn-minor" href="/admin/download-db">Download DB</a>
        </div>
        <div>
          <h3>Session</h3>
          <p>Sign out of the dashboard when you are done managing classes.</p>
          <button class="btn-ghost" id="settings-logout">Logout</button>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">Created by Pulindu Pansilu</footer>
</body>
</html>
